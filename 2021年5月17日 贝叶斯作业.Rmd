---
title: "2021年5月17日 贝叶斯作业"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# lab10
```{r}
x=seq(-10,10,0.1)
norm_y=dnorm(x)
logi_y=exp(-x)/(1+exp(-x))^2
cauc_y=1/3.1415926/(1+x^2)
stud_y=dt(x,5)
norm1_y=dnorm(x,1,2)
```

```{r}
library(ggplot2)
df=data.table(x=x,norm01=norm_y,logistic=logi_y,cauchy=cauc_y,
              student5=stud_y,norm12=norm1_y)
df=melt(df,id="x")
p=ggplot(df,aes(x=x,y=value,group=variable,color=variable))+
  geom_line()
p
```

```{r}
g=function(x){
  dt(x,5)
}

f=function(x){
  g(x)/dnorm(x)
}


reject_sample=function(n=1000){
  u=runif(n)
  norm_sample=rnorm(n)
  m=optimize(f, c(-10, 10), tol = 0.000001)$objective
  temp=m*dnorm(norm_sample)/g(norm_sample)
  target_sample=norm_sample[u<=temp]
  print(head(temp))
  list(accept_rate=m,target_sample=target_sample,
       real_accept_rate=length(target_sample)/n)
}

x=seq(-10,10,0.1)
norm_y=dnorm(x)
logi_y=exp(-x)/(1+exp(-x))^2
cauc_y=1/3.1415926/(1+x^2)
stud_y=dt(x,5)
norm1_y=dnorm(x,1,2)

temp=reject_sample(10000)

f_sample=density(temp$target_sample)
library(ggplot2)
p=ggplot()+geom_line(aes(x=f_sample$x,y=f_sample$y),colour="red")+
  geom_line(aes(x=x,stud_y))
print(p)
cat(temp$accept_rate,temp$real_accept_rate)
```
```{r}
g=function(x){
  1/3.1415926/(1+x^2)
}

temp=reject_sample(10000)

f_sample=density(temp$target_sample)
library(ggplot2)
p=ggplot()+geom_line(aes(x=f_sample$x,y=f_sample$y),colour="red")+
  geom_line(aes(x=x,cauc_y))
print(p)
cat(temp$accept_rate,temp$real_accept_rate)
```

