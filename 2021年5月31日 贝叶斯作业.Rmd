---
title: "2021年5月31日 贝叶斯作业"
author: "tassadar667"
date: "2021/5/31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
n <- 1000
p <- 3
epsilon <- rnorm(n, 0, 0.1)
beta <- matrix(c(-3, 1, 3, 5))
X <- cbind(1, matrix(runif(n * p), n))
y <- X %*% beta + epsilon

library(mvtnorm)
LogPosterior <- function(beta, sigma2, y, X) {
  p <- length(beta)
  ## The log likelihood function
  LogLikelihood <- sum(dnorm(x = y, mean = X %*% beta, sd = sqrt(sigma2), log = TRUE))
  ## The priors
  LogPrior4beta <- dmvnorm(x = t(beta), mean = matrix(0, 1, p), sigma = diag(p), log = TRUE)
  LogPrior4sigma2 <- dchisq(x = sigma2, df = 10, log = TRUE)
  LogPrior <- LogPrior4beta + LogPrior4sigma2
  ## The log posterior
  LogPosterior <- LogLikelihood + LogPrior
  return(LogPosterior)
}



```

