---
title: "2021年5月13日 非参数作业"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1
```{r}
library(data.table)
ridit.test=function(x){
  m=ncol(x)
  n=nrow(x)
  row_sum=rowSums(x)
  col_sum=colSums(x)
  temp=col_sum/2
  ac=c(0,cumsum(col_sum)[1:(m-1)])
  temp1=temp+ac
  r=temp1/sum(x)
  p=data.table("case"=col_sum,"case/2"=temp,"ac"=ac,"sum23"=temp1,"r"=r,"sum"=r*col_sum)
  ri=c()
  for (i in 1:n) {
    ri=c(ri,sum(r*x[i,])/sum(x[i,]))
  }
  for (i in 1:n) {
    up=ri+1/sqrt(3*row_sum)
    low=ri-1/sqrt(3*row_sum)
  }
  ri_table=data.table("r"=ri,low,up)
  w=12*sum((ri-0.5)^2*row_sum)
  p_value=1-pchisq(w,n-1)
  ans=list("comput_r"=p,"Ri"=ri_table,"W"=w,"Pvalue"=p_value)
  
}
x1=c(90,23,53,21,13)
x2=c(47,34,28,18,5)
x3=c(20,13,10,5,2)
x4=c(28,32,33,45,16)
x5=c(34,28,52,40,10)
x=matrix(c(x1,x2,x3,x4,x5),nrow = 5,byrow =TRUE)
ans=ridit.test(x)
print(ans)
```
使用Ridit检验法
$H_0:$各项满意度没有差异
$H_1:$各项满意度之间存在差异

P小于0.05，在显著性水平为0.05前提下，拒绝原假设，认为有差异。

# 2
```{r}
x1=c(20,112,342,309,86)
x2=c(7,77,203,459,123)
x3=c(11,61,402,339,56)
x4=c(10,62,342,369,86)
x5=c(9,11,162,388,299)
x=matrix(c(x1,x2,x3,x4,x5),nrow = 5,byrow =TRUE)
ans=ridit.test(x)
print(ans)
```

```{r}
x1=c(194,134,182,28,1,0)
x2=c(9,38,73,11,0,1)
x3=c(20,13,20,6,0,0)
x4=c(4,12,33,5,0,0)
x5=c(4,2,3,1,0,0)
x6=c(1,3,0,2,0,0)
x=matrix(c(x1,x2,x3,x4,x5,x6),nrow = 6,byrow =TRUE)
ans=ridit.test(x)
print(ans)
```
